\chapter{Арифметика в полях характеристики 2}
\section{Базисы конечных полей}
Здесь приведем основные сведения о стандартных и нормальных (в том числе и оптимальных) базисах описанные в \cite{bolotov1}.

\subsection{Стандартные и нормальные базисы}          
Через $GF(q^n)$ обозначим конечное поле порядка $q^n$, рассматриваемое как расширение степени n поля $GF(q)$ порядка q. 
В качестве представления элементов поля $GF(q^n)$ используем многочлены степени не более $n-1$ c коэффициентами из поля $GF(q)$.
Если многочлены записаны в стандартном базисе
$$B_{\alpha} = \{\alpha^0, \alpha^1, ... , \alpha^{n-1}\}$$
(в этом случае элемент $\alpha$ называем генератором базиса), то сложение элементов поля $GF(q^n)$ сводится к покомпонентному сложению в поле 
$GF(q)$ векторов коэффициентов, соответствующих данным многочленам, а умножение элементов поля есть умножение соответсвующих многочленов над полем
$GF(q)$, выполняемое по модулю неприводимого над полем $GF(q)$ многочлена $g(x)$, определяющего рассматриваемое представление поля.

Иногда вместо стандартного базиса удобнее так называемый нормальный базис, то есть базис вида
$$B^{\alpha} = \{\alpha^{q^0}, \alpha^{q^1}, ... , \alpha^{q^{n-1}}\}$$
который порождается генератором $\alpha$ стандартного базиса - корнем неприводимого над полем $GF(q)$ многочлена $g(x)$ в своем поле разложения $GF(q^n)$.
Нормальный базис существует для любого $n$, но порождается не всяким неприводимым многочленом $g(x)$, так как составляющие его степени элемента $\alpha$ 
должны быть линейно независимыми над полем $GF(q)$.

Если система степеней $$\{\alpha^{q^0}, \alpha^{q^1}, ... , \alpha^{q^{n-1}}\}$$ образует нормальный базис, то любой элемент $\zeta$ поля 
$GF(q^n)$ однозначно представляется в виде
$$\zeta = x_0\alpha + x_1\alpha^q + x_2\alpha^{q^2} + ... + x_{n-1}\alpha^{q^{n-1}}$$ 
где $x_0, ..., x_{n-1}$ - коэффициенты из поля $GF(q)$.

Сложение в нормальном базисе, как и в стандартном, есть покомпонентное сложение векторов коэффициентов в поле $GF(q^n)$.

Возведение в степень $q$ (а значит, и в любую степень $q^m$) в нормальном базисе представляет собой циклический сдвиг коэффициентов, так как
$$\zeta^q = x_{n-1}\alpha + x_0\alpha^q + x_1\alpha^{q^2} + ... + x_{n-2}\alpha^{q^{n-1}}$$

Рассмотрим умножение в нормальных базисах.

Сложностью $C_B$ произвольного нормального базиса 
$$B = \{\alpha, \alpha^{q^1}, \alpha^{q^2}, ... , \alpha^{q^{n-1}}\}$$
называется число ненулевых элементов в матрице $T$, $i$-я строка которой есть вектор коэффициентов элемента $\alpha\alpha^{q^i}$ поля $GF(q^n)$ 
относительно базиса $B$, то есть 
$$\alpha\alpha^{q^i} = \sum_{j=0}^{n-1}t_{i,j}\alpha^{q^i}$$

Это определение мотивируется алгоритмом Месси-Омуры умножения в нормальном базисе $B$.  

Пусть 
$$\xi=\sum_{i=0}^{n-1}x_i\alpha^{q^i},~~~~~~\zeta=\sum_{j=0}^{n-1}y_j\alpha^{q^j}$$
- произвольные элементы поля $GF(q^n)$, разложенные по нормальному базису $B$.
Тогда их произведение можно вычислить по формуле 
$$\pi=\xi\zeta=\sum_{i,j=0}^{n-1}x_iy_j\alpha^{q^i+q^j}=\sum_{i,j=0}^{n-1}x_iy_j\alpha^{(q^{i-j}+1)q^j},$$
где разность $i-j$ вычисляется по модулю n, а так как
$$\alpha^{(q^{i-j}+1)q^j}=(\alpha^{q^{i-j}+1})^{q^j}=(\sum_{k=0}^{n-1}t_{i-j,k}\alpha^{q^k})^{q^j}=
\sum_{k=0}^{n-1}t_{i-j,k}\alpha^{q^{k+j}}=\sum_{m=0}^{n-1}t_{i-j,m-j}\alpha^{q^m},$$
где разность $m-j$ и сумма $k+j$ тоже вычисляются по модулю n, то 
$$\pi=\sum_{m=0}^{n-1}p_m\alpha^{q^m},$$
где
$$p_m=\sum_{i,j=0}^{n-1}t_{i-j,m-j}x_iy_j.$$

Определив матрицу $A$ равенствами $a_{i,j}=t_{i-j,-j}$, где $i-j$ и $m-j$ вычисляются по модулю $n$, замечаем, что предыдущую формулу можно 
переписать в виде
\begin{align}
p_m=\sum_{i,j=0}^{n-1}t_{i-j,m-j}x_iy_j=\sum_{k,l=0}^{n-1}t_{k-l,-l}x_{k+m}y_{l+m}=\sum_{i,j=0}^{n-1}a_{i,j}x_{i+m}y_{j+m}=\nonumber\\
=\sum_{i,j=0}^{n-1}a_{i,j}S^m(x_i)S^m(y_j),\nonumber
\end{align}
где $S^m$ - операция циклического сдвига координат вектора на $m$ компонент, а 
$$A(x,y)=\sum_{i,j=0}^{n-1}a_{i,j}x_iy_j$$
- билинейная форма, связанная с матрицей $A$.

Матрица $A$ симметрическая и число $C_B$ ее ненулевых элементов, а также сумма элементов такие же, как и у матрицы $T$. Для вычисления билинейной формы
$A(x,y)$ достаточно выполнить $2C_B + n - 1$ сложений и умножений в поле $GF(q)$. Если пренебречь временем выполнения циклических сдвигов, то сложность
выполнения умножения над нормальным базисом поля $GF(q^n)$ оценивается сверху как $n(2C_B + n - 1)$ операций в поле $GF(q)$, что видно из следующей
основной формулы:
$$\xi\zeta=A(\xi,\zeta)\alpha + A(\xi^{q^{n-1}},\zeta^{q^{n-1}})\alpha^q + A(\xi^{q^{n-2}},\zeta^{q^{n-2}})\alpha^{q^2} + ... + 
A(\xi^q,\zeta^q)\alpha^{q^{n-1}}.$$

Таким образом, арифметическая сложность умножения зависит только от количества ненулевых элементов $C_B$ в матрице $A$. Верхняя граница сложности умножения
в произвольном нормальном базисе является кубической.
Матрица $A$ (таблица умножения в базисе $B$) однозначно определяет операцию умножения в рассматриваемом поле.

О сложности нормальных базисов известно следующее:
\begin{Theorem}
Для любого нормального базиса $B$ поля $GF(q^n)$ его сложность $C_B$ не меньше $2n-1$. Более того, если $q=2$, то сложность нечетна.
\end{Theorem}

Нормальные базисы, для которых достигается эта граница, называют оптимальными.

Для вычисления обратного элемента в оптимальном нормальном базисе используется следующая формула: $x^{-1}=x^{2n-2}, x \ne 0$.
Существует эффективный алгоритм подсчета правой части этой формулы. 

\subsection{Оптимальные нормальные базисы и их использование в стандартах ECDSA и ДСТУ 4145-2002}
Оптимальные нормальные базисы были описаны в \cite{mullin1}. В \cite{gao1} показано, что других оптимальных базисов, 
кроме найденных в \cite{mullin1}, не существует. 

Поскольку оптимальные нормальные базисы существуют не во всех полях, то необходимо заранее выбирать поле для операций. В украинском стандарте ДСТУ 4145-2002
для алгоритмов над эллиптическими кривыми в случае использования оптимальных нормальных базисов рекомендуют использовать следующие поля:
\begin{table}[htb] \label{table:table1}
\caption{Допустимые основные поля с оптимальным нормальным базисом}
\begin{small}
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
	Степень поля $n$ & 173 & 179 & 191 & 233 & 239 & 251 & 281 \\
\hline 
	Степень поля $n$ & 293 & 359 & 419 & 431 & 443 & 491 & 509 \\
\hline
\end{tabular}
\end{center}
\end{small}
\end{table}

Все степени, приведенные в таблице, являются простыми Софи-Жермен, т.е. для них выполняется условие:
если $p$ - простое Софи Жермен, то $2p+1$ - простое число.

Различают три типа оптимальных нормальных базисов в поле $GF(q^n)$ по типу их построения.

Первый тип оптимальных нормальных базисов можно построить, когда $n+1=p$ - простое число, а $q$ - примитивный корень по модулю $p$. 
В этом случае генератором оптимального нормального базиса будет один из примитивных корней $p$-й степени из единицы в поле $GF(q^n)$.

Второй тип оптимальных нормальных базисов возникает, когда $2n+1=p$ - простое число, а элемент $q$, как и в первом случае, - примитивный корень по модулю
$p$. Генератором этого базиса служит элемент $\alpha=\zeta+\zeta^{-1}$, где $\zeta$ - примитивный корень $p$-й степени из единицы в поле $GF(q^{2n})$.

Третий тип оптимальных нормальных базисов порождается, когда $2n+1=p$ - простое число, $p \equiv 3\mod4$, а $q$ - квадратичный вычет по модулю $p$ и любой
квадратичный вычет представляется в виде степени $q$ по модулю $p$ (или, другими словами, порядок элемента $q$ по модулю $p$ равен $n$). Как и в случае 
базиса второго типа в качестве порождающего элемента базиса третьего типа берется $\alpha = \zeta + \zeta^{-1}$,
где $\zeta$ - примитивный корень $p$-й степени из единицы в поле $GF(q^{2n})$.

В американском стандарте ECDSA рассматриваются гауссовы нормальные базисы, которые порождаются элементами вида 
$x = \zeta + \zeta^{\gamma} + ... +\zeta^{\gamma^{k-1}}$, $p=kn+1$ - простое число,
$\gamma$ - примитивный корень $p$-й степени из единицы в кольце вычетов порядка $p$. При этом базис называется базисом $k-$го типа. 
При $\gamma = 1$ или $2$ гауссов нормальный базис является оптимальным нормальным базисом.
При этом в тексте стандарта рекомендуют использовать именно эти типы гауссовых
нормальных базисов и приоритет отдается гауссову нормальному базису 2-го типа. Остюда заключаем, что рекомендации стандарта ECDSA совпадают 
c рекомендациями стандарта ДСТУ 4145-2002. Поэтому далее будем рассматривать только поля, предложенные стандартом ДСТУ 4145-2002.
Все эти поля имеют либо ОНБ 2-го, либо ОНБ 3-го типа.\cite{bolotov2}
