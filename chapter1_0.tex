\chapter{Генерация простых чисел}
\section{Постановка задач}
Для генерации простых чисел используются различные методы: детерменированный алгоритм генерации простого числа по заданному числу (seed),
решето Эратосфена и тому подобные алгоритмы, генерация случайного числа с последующей проверкой его на вероятностных тестах. \cite{menezes}

В этой работе для будем оптимизировать генерацию простого числа с помощью проверки случаного числа в тесте на простоту (в Частности теста Миллера-Рабина).
Наша цель заключается в выработке некоторого предварительного этапа, после которого вероятность теста Рабина-Миллера
была бы выше, чем без него(не в ущерб времени выполнения с наперед заданной вероятностью). Для выполнения этой задачи есть некоторые подходы, описанные ниже. 
Речь пойдет о следующем: 

\subsection{Фактор-множество}
На любом конечном интервале натуральных чисел почти половина чисел делится на 2, примерно треть на три и так далее.
Таким образом, проверив делимость числа на малые простые, мы многократно повысим вероятность того, что оно простое.
Поэтому есть смысл ее проверить. Создадим множество простых последовательных чисел, назовем его 
фактор-множеством, и обозначим $F$, где $F~=~\{x_i~|~x_i~\in~PRIMES\}$. Ниже будет описан алгоритм быстрого нахождения остатка от деления на малое число ModDigit.
В нем есть некоторый порог $m$, который означает, что можно быстро найти остаток от деления числа $n$ на число, не большее $m$.
При построении фактор-множества придется это учесть.

При увеличении мощности фактор-множества растет вероятность успеха теста Миллера-Рабина, и в предельном случае когда фактор-множество
максимально, вероятность теста равна 1, но асимптотика времени работы - экспоненциальна. 
Таким образом задача состоит в оценке мощности фактор-множества.

\subsection{Разбиение}
Существует также следующая оптимизация: фактор-множество можно разбить на подмножества, внутри которых произведение чисел меньше порога для 
алгоритма ModDigit. Пусть $F~=~\{F'_i\}, F'_i~=~\{x_{ij}\}, \prod{x_{ij}}~<~m$, $m$ - порог алоритма ModDigits \cite{knut}. 
Очевидно, что мощность множества $\{F'_i\}$ меньше мощности множества $\{x_i\}$. В этом случае количество вызовов алгоритма ModDigits меньше.
Тогда множество остатков нужно считать немного по-другому: сначала находим все $n'_i~=~n~(mod~\prod{x_{ij}})$, затем
$n'_{ij}~=~n'_i~(mod~x_{ij})$. $R_n~=~\{n'_{ij}\}$. 
Таким образом стоит задача оптимального разбиения фактор-множества. 

\subsection{Увеличение порога}
Предположим, что решив задачу оценки мощности фактор-множества, обнаружим, что этот порог настолько большой, что в фактор-множестве найдутся
числа, большие порога для алгоритма быстрого деления. Тогда встает еще одна задача: можно ли модифицировать алгоритм ModDigits
таким образом, чтобы его порог можно было увеличить в достаточное число раз?

\subsection{Множество кандидатов} 
Составим множество остатков $R_n~=~\{n_i~=~n~(mod~x_i)~|~x_i~\in~F\}$. Если хотя бы одно из $n_i$ равно нулю, то число n - составное. 
Отметим, чтобы составить множество $R_{n+2}$ не нужны приведения по модулю больших чисел, а всего лишь сложение по модулю для маленьких
$R_{n+2}~=~\{n_i~+~2~(mod~x_i)~|~n_i~\in~R_n\}$. Таким образом можно быстро проверить делимость на малые простые некоторого множества кандидатов, назовем его
$K$. Понятно, что когда-либо в множество кандидатов добавится число, взаимно простое с фактор-множеством. Только при этом может статься, что 
мощность множества кандидатов велика настолько, что проверка этого множества требует больше времени, чем тест Миллера-Рабина для случайных чисел.
Поэтому стоит задача оценки мощности множества кандидатов.
